
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
cat ./realtime-service/.env
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"
echo "#######################################################################################"


# Start selenium
echo "#######################################################################################"
echo "########                      Start the selenium server                        ########"
echo "#######################################################################################"

/opt/bin/entry_point.sh &

sleep 10

# Start the dev-server
echo "#######################################################################################"
echo "########                         Start the devserver                           ########"
echo "#######################################################################################"

sudo /usr/local/gcloud/google-cloud-sdk/bin/java_dev_appserver.sh --disable_update_check --port=8888 /app/target/qdacity-war/ &

# Run a script which waits until the specified port is open (=> the dev-server is running)
./docker/acceptance-tests/waitForDevServer.sh

# Start RTCSVC
echo "#######################################################################################"
echo "########                      Start the realtime service                       ########"
echo "#######################################################################################"

cd realtime-service
npm run start &
cd ..

sleep 10

# Start the tests
echo "#######################################################################################"
echo "########                            Start the tests                            ########"
echo "#######################################################################################"

cd war
./node_modules/.bin/gulp acceptance-tests
